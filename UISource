local genv = getgenv()
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

local LocalPlayer = Players.LocalPlayer
local Color3 = Color3
local UDim2 = UDim2
local Vector2 = Vector2
local TweenInfo = TweenInfo
local Enum = Enum
local Instance = Instance

local function getGuiParent()
    if gethui then
        return gethui()
    elseif game.CoreGui then
        return game.CoreGui
    else
        return LocalPlayer:WaitForChild("PlayerGui")
    end
end

local COLORS = {
    DarkBlue = Color3.fromRGB(16, 24, 39),
    DarkerBlue = Color3.fromRGB(12, 18, 32),
    MediumBlue = Color3.fromRGB(21, 30, 47),
    LightBlue = Color3.fromRGB(10, 82, 120),
    Cyan = Color3.fromRGB(56, 189, 248),
    LightCyan = Color3.fromRGB(56, 189, 248),
    GrayBlue = Color3.fromRGB(30, 41, 59),
    DarkGrayBlue = Color3.fromRGB(25, 32, 48),
    BrightCyan = Color3.fromRGB(52, 180, 230),
    White = Color3.fromRGB(241, 245, 249),
    LightGray = Color3.fromRGB(148, 163, 184),
    Red = Color3.fromRGB(239, 68, 68)
}

local GothamBold = Enum.Font.GothamBold
local GothamMedium = Enum.Font.GothamMedium
local Gotham = Enum.Font.Gotham

local function ensureFolder(path)
    if not isfolder(path) then
        makefolder(path)
    end
end

local function safeListFiles(path)
    if isfolder(path) then
        return listfiles(path)
    end
    return {}
end

local MemberLib = {
    Options = {},
    Folder = "MemberLib",
    
    LoadConfig = function(self, configName)
        local path = self.Folder .. "/settings/" .. configName .. ".json"
        if isfile(path) then
            local success, data = pcall(function()
                return HttpService:JSONDecode(readfile(path))
            end)
            if success then
                return true, data
            end
        end
        return false, "No file"
    end,
    
    SaveConfig = function(self, configName, data)
        local path = self.Folder .. "/settings/" .. configName .. ".json"
        ensureFolder(self.Folder)
        ensureFolder(self.Folder .. "/settings")
        
        pcall(function()
            writefile(path, HttpService:JSONEncode(data))
        end)
    end,
    
    RefreshConfigList = function(self)
        local path = self.Folder .. "/settings"
        ensureFolder(self.Folder)
        ensureFolder(path)
        
        local configs = {}
        for _, file in ipairs(safeListFiles(path)) do
            if string.match(file, "%.json$") then
                table.insert(configs, file)
            end
        end
        return configs
    end,
    
    SetFolder = function(self, folderName)
        self.Folder = folderName
        ensureFolder(folderName)
        ensureFolder(folderName .. "/settings")
    end,
    
    GetService = function(serviceName)
        return game:GetService(serviceName)
    end,
    
    Window = function(self, options)
        local settings = {
            Title = options.Title or "Member Interface",
            Size = options.Size or UDim2.fromOffset(650, 400)
        }
        
        local MainGUI = Instance.new("ScreenGui")
        MainGUI.Name = "MemberLibUI"
        MainGUI.ScreenInsets = Enum.ScreenInsets.None
        MainGUI.ResetOnSpawn = false
        MainGUI.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        MainGUI.DisplayOrder = 10000
        MainGUI.Parent = getGuiParent()
        
        local MainFrame = Instance.new("Frame")
        MainFrame.Name = "MainBase"
        MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
        MainFrame.Position = UDim2.fromScale(0.5, 0.5)
        MainFrame.Size = UDim2.new(0, 0, 0, 0)
        MainFrame.Visible = true
        MainFrame.ClipsDescendants = true
        MainFrame.BackgroundColor3 = COLORS.DarkBlue
        MainFrame.BorderSizePixel = 0
        MainFrame.Parent = MainGUI
        
        local UICorner = Instance.new("UICorner", MainFrame)
        UICorner.CornerRadius = UDim.new(0, 20)
        
        local UIGradient = Instance.new("UIGradient", MainFrame)
        UIGradient.Rotation = 35
        UIGradient.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, COLORS.DarkerBlue),
            ColorSequenceKeypoint.new(0.55, COLORS.MediumBlue),
            ColorSequenceKeypoint.new(1, COLORS.LightBlue)
        })
        
        local UIStroke1 = Instance.new("UIStroke", MainFrame)
        UIStroke1.Thickness = 3
        UIStroke1.Transparency = 0.8
        UIStroke1.Color = COLORS.Cyan
        UIStroke1.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        
        local UIStroke2 = Instance.new("UIStroke", MainFrame)
        UIStroke2.Thickness = 1
        UIStroke2.Transparency = 0.5
        UIStroke2.Color = COLORS.LightCyan
        UIStroke2.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
        
        local openTween = TweenService:Create(MainFrame, TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
            Size = settings.Size
        })
        openTween:Play()
        
        local TopBar = Instance.new("Frame")
        TopBar.Name = "TopBar"
        TopBar.Parent = MainFrame
        TopBar.BackgroundColor3 = COLORS.DarkGrayBlue
        TopBar.BackgroundTransparency = 0.3
        TopBar.BorderSizePixel = 0
        TopBar.Size = UDim2.new(1, -14, 0, 32)
        TopBar.Position = UDim2.new(0, 7, 0, 7)
        
        local TopBarCorner = Instance.new("UICorner", TopBar)
        TopBarCorner.CornerRadius = UDim.new(0, 12)
        
        local TitleLabel = Instance.new("TextLabel")
        TitleLabel.Parent = TopBar
        TitleLabel.BackgroundTransparency = 0
        TitleLabel.Position = UDim2.new(0, 16, 0, 0)
        TitleLabel.Size = UDim2.new(1, -80, 1, 0)
        TitleLabel.Font = GothamBold
        TitleLabel.Text = settings.Title
        TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
        TitleLabel.TextSize = 18
        TitleLabel.TextColor3 = COLORS.White
        
        local TitleGradient = Instance.new("UIGradient", TitleLabel)
        TitleGradient.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromRGB(34, 211, 238)),
            ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 255, 255)),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(99, 102, 241))
        })
        
        local CloseButton = Instance.new("TextButton", TopBar)
        CloseButton.Size = UDim2.fromOffset(24, 24)
        CloseButton.Position = UDim2.new(1, -30, 0.5, -12)
        CloseButton.BackgroundColor3 = COLORS.GrayBlue
        CloseButton.Text = "X"
        CloseButton.Font = GothamBold
        CloseButton.TextSize = 14
        CloseButton.TextColor3 = COLORS.Red
        CloseButton.AutoButtonColor = true
        
        local CloseButtonCorner = Instance.new("UICorner", CloseButton)
        CloseButtonCorner.CornerRadius = UDim.new(0, 8)
        
        local CloseButtonStroke = Instance.new("UIStroke", CloseButton)
        CloseButtonStroke.Color = COLORS.LightCyan
        CloseButtonStroke.Transparency = 0.7
        CloseButtonStroke.Thickness = 1
        
        local ContentContainer = Instance.new("Frame", MainFrame)
        ContentContainer.BackgroundTransparency = 1
        ContentContainer.Position = UDim2.new(0, 10, 0, 45)
        ContentContainer.Size = UDim2.new(1, -20, 1, -50)
        
        local Sidebar = Instance.new("ScrollingFrame", ContentContainer)
        Sidebar.Size = UDim2.new(0, 105, 1, 0)
        Sidebar.BackgroundTransparency = 1
        Sidebar.ScrollBarThickness = 2
        Sidebar.BorderSizePixel = 0
        Sidebar.CanvasSize = UDim2.new(0, 0, 0, 0)
        Sidebar.AutomaticCanvasSize = Enum.AutomaticSize.None
        
        local SidebarLayout = Instance.new("UIListLayout", Sidebar)
        SidebarLayout.Padding = UDim.new(0, 6)
        SidebarLayout.SortOrder = Enum.SortOrder.LayoutOrder
        
        local Separator = Instance.new("Frame", ContentContainer)
        Separator.Size = UDim2.new(0, 1, 1, 0)
        Separator.Position = UDim2.new(0, 115, 0, 0)
        Separator.BackgroundColor3 = COLORS.LightCyan
        Separator.BackgroundTransparency = 0.8
        Separator.BorderSizePixel = 0
        
        local ContentArea = Instance.new("Frame", ContentContainer)
        ContentArea.Size = UDim2.new(1, -125, 1, 0)
        ContentArea.Position = UDim2.new(0, 125, 0, 0)
        ContentArea.BackgroundTransparency = 1
        ContentArea.ClipsDescendants = true
        
        CloseButton.MouseButton1Click:Connect(function()
            local closeTween = TweenService:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
                Size = UDim2.new(0, 0, 0, 0)
            })
            closeTween:Play()
            task.delay(0.26, function()
                MainFrame.Visible = false
            end)
        end)
        
        local dragging = false
        local dragInput, dragStart, startPos
        
        local function update(input)
            local delta = input.Position - dragStart
            MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        end
        
        TopBar.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
                dragging = true
                dragStart = input.Position
                startPos = MainFrame.Position
                
                input.Changed:Connect(function()
                    if input.UserInputState == Enum.UserInputState.End then
                        dragging = false
                    end
                end)
            end
        end)
        
        TopBar.InputChanged:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
                dragInput = input
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and input == dragInput then
                update(input)
            end
        end)
        
        local windowObject = {
            MainFrame = MainFrame,
            Settings = settings,
            
            Show = function()
                MainFrame.Visible = true
                local showTween = TweenService:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
                    Size = settings.Size
                })
                showTween:Play()
            end,
            
            Hide = function()
                local hideTween = TweenService:Create(MainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.In), {
                    Size = UDim2.new(0, 0, 0, 0)
                })
                hideTween:Play()
                task.delay(0.26, function()
                    MainFrame.Visible = false
                end)
            end,
            
            Toggle = function()
                if MainFrame.Visible then
                    windowObject:Hide()
                else
                    windowObject:Show()
                end
            end,
            
            Destroy = function()
                MainGUI:Destroy()
            end,
            
            TabGroup = function()
                local tabs = {}
                local selectedTab = nil
                
                local function updateSidebarCanvas()
                    Sidebar.CanvasSize = UDim2.new(0, 0, 0, SidebarLayout.AbsoluteContentSize.Y)
                end
                
                -- update canvas if layout changes (so scrolling works)
                SidebarLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateSidebarCanvas)
                
                return {
                    Tab = function(tabOptions)
                        local tabName = tabOptions.Title or "Tab"
                        local tabIcon = tabOptions.Image or ""
                        
                        local TabButton = Instance.new("TextButton", Sidebar)
                        TabButton.Size = UDim2.new(1, -8, 0, 36)
                        TabButton.BackgroundColor3 = COLORS.GrayBlue
                        TabButton.BackgroundTransparency = 1
                        TabButton.Text = ""
                        TabButton.AutoButtonColor = true
                        TabButton.LayoutOrder = #tabs + 1
                        
                        local TabButtonCorner = Instance.new("UICorner", TabButton)
                        TabButtonCorner.CornerRadius = UDim.new(0, 10)
                        
                        local TabButtonStroke = Instance.new("UIStroke", TabButton)
                        TabButtonStroke.Transparency = 1
                        TabButtonStroke.Color = COLORS.BrightCyan
                        TabButtonStroke.Thickness = 1
                        
                        local TabIndicator = Instance.new("Frame", TabButton)
                        TabIndicator.Size = UDim2.new(0, 3, 1, -8)
                        TabIndicator.Position = UDim2.new(0, 4, 0, 4)
                        TabIndicator.BackgroundColor3 = COLORS.BrightCyan
                        TabIndicator.BorderSizePixel = 0
                        TabIndicator.BackgroundTransparency = 1
                        
                        -- Add label so tab name shows
                        local TabLabel = Instance.new("TextLabel", TabButton)
                        TabLabel.Size = UDim2.new(1, -12, 1, 0)
                        TabLabel.Position = UDim2.new(0, 8, 0, 0)
                        TabLabel.BackgroundTransparency = 1
                        TabLabel.Text = tabName
                        TabLabel.Font = GothamMedium
                        TabLabel.TextSize = 14
                        TabLabel.TextColor3 = COLORS.White
                        TabLabel.TextXAlignment = Enum.TextXAlignment.Left
                        
                        local TabContent = Instance.new("ScrollingFrame", ContentArea)
                        TabContent.Size = UDim2.fromScale(1, 1)
                        TabContent.BackgroundTransparency = 1
                        TabContent.Visible = false
                        TabContent.ScrollBarThickness = 2
                        TabContent.ScrollBarImageColor3 = COLORS.BrightCyan
                        TabContent.BorderSizePixel = 0
                        TabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
                        TabContent.AutomaticCanvasSize = Enum.AutomaticSize.Y
                        
                        local TabContentLayout = Instance.new("UIListLayout", TabContent)
                        TabContentLayout.Padding = UDim.new(0, 12)
                        TabContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
                        
                        local TabContentPadding = Instance.new("UIPadding", TabContent)
                        TabContentPadding.PaddingLeft = UDim.new(0, 4)
                        TabContentPadding.PaddingRight = UDim.new(0, 4)
                        TabContentPadding.PaddingTop = UDim.new(0, 4)
                        TabContentPadding.PaddingBottom = UDim.new(0, 10)
                        
                        local function selectTab()
                            for _, otherTab in pairs(tabs) do
                                if otherTab.Content ~= TabContent then
                                    otherTab.Content.Visible = false
                                    TweenService:Create(otherTab.Button, TweenInfo.new(0.2), {
                                        BackgroundTransparency = 1
                                    }):Play()
                                    -- hide indicator
                                    if otherTab.Indicator then
                                        TweenService:Create(otherTab.Indicator, TweenInfo.new(0.2), {BackgroundTransparency = 1}):Play()
                                    end
                                end
                            end
                            
                            TabContent.Visible = true
                            TabContent.Position = UDim2.new(0, 10, 0, 0)
                            
                            local slideIn = TweenService:Create(TabContent, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
                                Position = UDim2.new(0, 0, 0, 0)
                            })
                            slideIn:Play()
                            
                            TweenService:Create(TabButton, TweenInfo.new(0.2), {
                                BackgroundTransparency = 0
                            }):Play()
                            
                            TweenService:Create(TabButtonStroke, TweenInfo.new(0.2), {
                                Transparency = 0.4
                            }):Play()
                            
                            TweenService:Create(TabIndicator, TweenInfo.new(0.2), {
                                BackgroundTransparency = 0
                            }):Play()
                            
                            selectedTab = {
                                Button = TabButton,
                                Content = TabContent,
                                Indicator = TabIndicator
                            }
                        end
                        
                        TabButton.MouseButton1Click:Connect(selectTab)
                        
                        table.insert(tabs, {
                            Button = TabButton,
                            Content = TabContent,
                            Select = selectTab,
                            Indicator = TabIndicator
                        })
                        
                        -- Update sidebar canvas immediately (and after a short wait for layout)
                        updateSidebarCanvas()
                        task.defer(updateSidebarCanvas)
                        
                        -- If first tab, auto-select
                        if #tabs == 1 then
                            task.delay(0.05, selectTab)
                        end
                        
                        return {
                            Section = function(sectionOptions)
                                local sectionName = sectionOptions.Title or "Section"
                                
                                local SectionFrame = Instance.new("Frame", TabContent)
                                SectionFrame.Size = UDim2.new(1, -2, 0, 0)
                                SectionFrame.AutomaticSize = Enum.AutomaticSize.Y
                                SectionFrame.BackgroundTransparency = 0
                                SectionFrame.ClipsDescendants = true
                                SectionFrame.BackgroundColor3 = COLORS.DarkBlue
                                SectionFrame.BorderSizePixel = 0
                                
                                local SectionCorner = Instance.new("UICorner", SectionFrame)
                                SectionCorner.CornerRadius = UDim.new(0, 12)
                                
                                local SectionStroke1 = Instance.new("UIStroke", SectionFrame)
                                SectionStroke1.Thickness = 3
                                SectionStroke1.Transparency = 0.8
                                SectionStroke1.Color = COLORS.Cyan
                                SectionStroke1.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
                                
                                local SectionStroke2 = Instance.new("UIStroke", SectionFrame)
                                SectionStroke2.Thickness = 1
                                SectionStroke2.Transparency = 0.5
                                SectionStroke2.Color = COLORS.LightCyan
                                SectionStroke2.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
                                
                                local SectionPadding = Instance.new("UIPadding", SectionFrame)
                                SectionPadding.PaddingTop = UDim.new(0, 4)
                                SectionPadding.PaddingBottom = UDim.new(0, 4)
                                SectionPadding.PaddingLeft = UDim.new(0, 2)
                                SectionPadding.PaddingRight = UDim.new(0, 2)
                                
                                local SectionHeader = Instance.new("TextButton", SectionFrame)
                                SectionHeader.Size = UDim2.new(1, -16, 0, 24)
                                SectionHeader.Position = UDim2.new(0, 8, 0, 4)
                                SectionHeader.BackgroundTransparency = 1
                                SectionHeader.Text = ""
                                
                                local SectionTitle = Instance.new("TextLabel", SectionHeader)
                                SectionTitle.Text = sectionName
                                SectionTitle.Font = GothamBold
                                SectionTitle.TextSize = 16
                                SectionTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
                                SectionTitle.Size = UDim2.new(1, -20, 1, 0)
                                SectionTitle.BackgroundTransparency = 1
                                SectionTitle.TextXAlignment = Enum.TextXAlignment.Left
                                
                                local ContentHolder = Instance.new("Frame", SectionFrame)
                                ContentHolder.Name = "ContentHolder"
                                ContentHolder.BackgroundTransparency = 1
                                ContentHolder.Position = UDim2.new(0, 8, 0, 32)
                                ContentHolder.Size = UDim2.new(1, -16, 0, 0)
                                ContentHolder.AutomaticSize = Enum.AutomaticSize.Y
                                
                                local ContentLayout = Instance.new("UIListLayout", ContentHolder)
                                ContentLayout.Padding = UDim.new(0, 8)
                                ContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
                                ContentLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
                                
                                local ContentPadding = Instance.new("UIPadding", ContentHolder)
                                ContentPadding.PaddingBottom = UDim.new(0, 6)
                                
                                return {
                                    Label = function(labelOptions)
                                        local labelFrame = Instance.new("Frame", ContentHolder)
                                        labelFrame.Size = UDim2.new(1, 0, 0, 24)
                                        labelFrame.BackgroundTransparency = 1
                                        
                                        local labelText = Instance.new("TextLabel", labelFrame)
                                        labelText.Size = UDim2.new(1, -10, 1, 0)
                                        labelText.Position = UDim2.new(0, 10, 0, 0)
                                        labelText.BackgroundTransparency = 1
                                        labelText.Text = labelOptions.Title or "Label"
                                        labelText.Font = GothamMedium
                                        labelText.TextSize = 14
                                        labelText.TextColor3 = COLORS.White
                                        labelText.TextXAlignment = Enum.TextXAlignment.Left
                                        
                                        return {
                                            SetText = function(newText)
                                                labelText.Text = newText
                                            end
                                        }
                                    end,
                                    
                                    Button = function(buttonOptions)
                                        local buttonFrame = Instance.new("Frame", ContentHolder)
                                        buttonFrame.Size = UDim2.new(1, 0, 0, 36)
                                        buttonFrame.BackgroundColor3 = COLORS.BrightCyan
                                        buttonFrame.BackgroundTransparency = 0.9
                                        
                                        local buttonCorner = Instance.new("UICorner", buttonFrame)
                                        buttonCorner.CornerRadius = UDim.new(0, 8)
                                        
                                        local button = Instance.new("TextButton", buttonFrame)
                                        button.Size = UDim2.fromScale(1, 1)
                                        button.BackgroundTransparency = 1
                                        button.Text = buttonOptions.Title or "Button"
                                        button.Font = GothamBold
                                        button.TextColor3 = COLORS.BrightCyan
                                        button.TextSize = 14
                                        button.AutoButtonColor = true
                                        
                                        button.MouseButton1Click:Connect(function()
                                            if buttonOptions.Callback then
                                                buttonOptions.Callback()
                                            end
                                        end)
                                        
                                        return {
                                            SetTitle = function(newTitle)
                                                button.Text = newTitle
                                            end
                                        }
                                    end,
                                    
                                    Toggle = function(toggleOptions)
                                        local toggleFrame = Instance.new("Frame", ContentHolder)
                                        toggleFrame.Size = UDim2.new(1, 0, 0, 38)
                                        toggleFrame.BackgroundColor3 = Color3.fromRGB(15, 20, 30)
                                        toggleFrame.BackgroundTransparency = 0.5
                                        
                                        local toggleCorner = Instance.new("UICorner", toggleFrame)
                                        toggleCorner.CornerRadius = UDim.new(0, 8)
                                        
                                        local titleLabel = Instance.new("TextLabel", toggleFrame)
                                        titleLabel.Size = UDim2.new(1, -10, 1, 0)
                                        titleLabel.Position = UDim2.new(0, 10, 0, 0)
                                        titleLabel.BackgroundTransparency = 1
                                        titleLabel.Text = toggleOptions.Title or "Toggle"
                                        titleLabel.Font = GothamMedium
                                        titleLabel.TextSize = 14
                                        titleLabel.TextColor3 = COLORS.White
                                        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
                                        
                                        local toggleButton = Instance.new("TextButton", toggleFrame)
                                        toggleButton.Size = UDim2.fromScale(1, 1)
                                        toggleButton.BackgroundTransparency = 1
                                        toggleButton.Text = ""
                                        
                                        local toggleBackground = Instance.new("Frame", toggleFrame)
                                        toggleBackground.Size = UDim2.fromOffset(40, 20)
                                        toggleBackground.Position = UDim2.new(1, -50, 0.5, -10)
                                        toggleBackground.BackgroundColor3 = COLORS.GrayBlue
                                        toggleBackground.BackgroundTransparency = 0.1
                                        
                                        local toggleBgCorner = Instance.new("UICorner", toggleBackground)
                                        toggleBgCorner.CornerRadius = UDim.new(1, 0)
                                        
                                        local toggleCircle = Instance.new("Frame", toggleBackground)
                                        toggleCircle.Size = UDim2.fromOffset(16, 16)
                                        toggleCircle.Position = UDim2.new(0, 2, 0.5, -8)
                                        toggleCircle.BackgroundColor3 = COLORS.White
                                        
                                        local toggleCircleCorner = Instance.new("UICorner", toggleCircle)
                                        toggleCircleCorner.CornerRadius = UDim.new(1, 0)
                                        
                                        local state = toggleOptions.Default or false
                                        
                                        local function updateToggle()
                                            if state then
                                                TweenService:Create(toggleBackground, TweenInfo.new(0.2), {
                                                    BackgroundColor3 = COLORS.BrightCyan,
                                                    BackgroundTransparency = 0
                                                }):Play()
                                                TweenService:Create(toggleCircle, TweenInfo.new(0.2), {
                                                    Position = UDim2.new(1, -18, 0.5, -8)
                                                }):Play()
                                            else
                                                TweenService:Create(toggleBackground, TweenInfo.new(0.2), {
                                                    BackgroundColor3 = COLORS.GrayBlue,
                                                    BackgroundTransparency = 0.1
                                                }):Play()
                                                TweenService:Create(toggleCircle, TweenInfo.new(0.2), {
                                                    Position = UDim2.new(0, 2, 0.5, -8)
                                                }):Play()
                                            end
                                            
                                            if toggleOptions.Callback then
                                                toggleOptions.Callback(state)
                                            end
                                        end
                                        
                                        toggleButton.MouseButton1Click:Connect(function()
                                            state = not state
                                            updateToggle()
                                        end)
                                        
                                        updateToggle()
                                        
                                        return {
                                            Value = state,
                                            Set = function(newState)
                                                state = newState
                                                updateToggle()
                                            end
                                        }
                                    end,
                                    
                                    Slider = function(sliderOptions)
                                        local sliderFrame = Instance.new("Frame", ContentHolder)
                                        sliderFrame.Size = UDim2.new(1, 0, 0, 50)
                                        sliderFrame.BackgroundColor3 = Color3.fromRGB(15, 20, 30)
                                        sliderFrame.BackgroundTransparency = 0.5
                                        
                                        local sliderCorner = Instance.new("UICorner", sliderFrame)
                                        sliderCorner.CornerRadius = UDim.new(0, 8)
                                        
                                        local titleLabel = Instance.new("TextLabel", sliderFrame)
                                        titleLabel.Size = UDim2.new(1, -10, 0, 25)
                                        titleLabel.Position = UDim2.new(0, 10, 0, 0)
                                        titleLabel.BackgroundTransparency = 1
                                        titleLabel.Text = sliderOptions.Title or "Slider"
                                        titleLabel.Font = GothamMedium
                                        titleLabel.TextSize = 14
                                        titleLabel.TextColor3 = COLORS.White
                                        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
                                        
                                        local valueLabel = Instance.new("TextLabel", sliderFrame)
                                        valueLabel.Size = UDim2.new(0, 50, 0, 25)
                                        valueLabel.Position = UDim2.new(1, -60, 0, 0)
                                        valueLabel.BackgroundTransparency = 1
                                        valueLabel.Text = tostring(sliderOptions.Default or sliderOptions.Min or 0)
                                        valueLabel.TextColor3 = COLORS.BrightCyan
                                        valueLabel.Font = GothamBold
                                        valueLabel.TextSize = 13
                                        valueLabel.TextXAlignment = Enum.TextXAlignment.Right
                                        
                                        local sliderBar = Instance.new("Frame", sliderFrame)
                                        sliderBar.Size = UDim2.new(0.85, -20, 0, 4)
                                        sliderBar.Position = UDim2.new(0, 10, 0, 32)
                                        sliderBar.BackgroundColor3 = COLORS.GrayBlue
                                        
                                        local sliderBarCorner = Instance.new("UICorner", sliderBar)
                                        sliderBarCorner.CornerRadius = UDim.new(1, 0)
                                        
                                        local sliderFill = Instance.new("Frame", sliderBar)
                                        sliderFill.Size = UDim2.new(0, 0, 1, 0)
                                        sliderFill.BackgroundColor3 = COLORS.BrightCyan
                                        
                                        local sliderFillCorner = Instance.new("UICorner", sliderFill)
                                        sliderFillCorner.CornerRadius = UDim.new(1, 0)
                                        
                                        local min = sliderOptions.Min or 0
                                        local max = sliderOptions.Max or 100
                                        local default = sliderOptions.Default or min
                                        local value = default
                                        
                                        local function updateSlider(newValue)
                                            value = math.clamp(newValue, min, max)
                                            local percentage = (value - min) / (max - min)
                                            
                                            TweenService:Create(sliderFill, TweenInfo.new(0.1), {
                                                Size = UDim2.new(percentage, 0, 1, 0)
                                            }):Play()
                                            
                                            valueLabel.Text = tostring(math.floor(value))
                                            
                                            if sliderOptions.Callback then
                                                sliderOptions.Callback(value)
                                            end
                                        end
                                        
                                        local sliderButton = Instance.new("TextButton", sliderBar)
                                        sliderButton.Size = UDim2.fromScale(1, 1)
                                        sliderButton.BackgroundTransparency = 1
                                        sliderButton.Text = ""
                                        
                                        local dragging = false
                                        
                                        sliderButton.InputBegan:Connect(function(input)
                                            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                                                dragging = true
                                            end
                                        end)
                                        
                                        UserInputService.InputChanged:Connect(function(input)
                                            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                                                local relativeX = (input.Position.X - sliderBar.AbsolutePosition.X) / sliderBar.AbsoluteSize.X
                                                local newValue = min + (relativeX * (max - min))
                                                updateSlider(newValue)
                                            end
                                        end)
                                        
                                        UserInputService.InputEnded:Connect(function(input)
                                            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                                                dragging = false
                                            end
                                        end)
                                        
                                        updateSlider(default)
                                        
                                        return {
                                            Value = value,
                                            Set = function(newValue)
                                                updateSlider(newValue)
                                            end
                                        }
                                    end,
                                    
                                    Input = function(inputOptions)
                                        local inputFrame = Instance.new("Frame", ContentHolder)
                                        inputFrame.Size = UDim2.new(1, 0, 0, 38)
                                        inputFrame.BackgroundColor3 = Color3.fromRGB(15, 20, 30)
                                        inputFrame.BackgroundTransparency = 0.5
                                        
                                        local inputCorner = Instance.new("UICorner", inputFrame)
                                        inputCorner.CornerRadius = UDim.new(0, 8)
                                        
                                        local titleLabel = Instance.new("TextLabel", inputFrame)
                                        titleLabel.Size = UDim2.new(1, -10, 1, 0)
                                        titleLabel.Position = UDim2.new(0, 10, 0, 0)
                                        titleLabel.BackgroundTransparency = 1
                                        titleLabel.Text = inputOptions.Title or "Input"
                                        titleLabel.Font = GothamMedium
                                        titleLabel.TextSize = 14
                                        titleLabel.TextColor3 = COLORS.White
                                        titleLabel.TextXAlignment = Enum.TextXAlignment.Left
                                        
                                        local textBoxFrame = Instance.new("Frame", inputFrame)
                                        textBoxFrame.Size = UDim2.new(0, 60, 0, 26)
                                        textBoxFrame.Position = UDim2.new(1, -70, 0.5, -13)
                                        textBoxFrame.BackgroundColor3 = COLORS.DarkBlue
                                        
                                        local textBoxCorner = Instance.new("UICorner", textBoxFrame)
                                        textBoxCorner.CornerRadius = UDim.new(0, 6)
                                        
                                        local textBox = Instance.new("TextBox", textBoxFrame)
                                        textBox.Size = UDim2.new(1, -10, 1, 0)
                                        textBox.Position = UDim2.new(0, 5, 0, 0)
                                        textBox.BackgroundTransparency = 1
                                        textBox.Text = inputOptions.Default or ""
                                        textBox.PlaceholderText = inputOptions.Placeholder or "..."
                                        textBox.TextColor3 = COLORS.White
                                        textBox.Font = GothamBold
                                        textBox.TextSize = 14
                                        textBox.ClearTextOnFocus = false
                                        
                                        textBox.FocusLost:Connect(function()
                                            if inputOptions.Callback then
                                                inputOptions.Callback(textBox.Text)
                                            end
                                        end)
                                        
                                        return {
                                            Value = textBox.Text,
                                            Set = function(newText)
                                                textBox.Text = newText
                                            end
                                        }
                                    end
                                }
                            end
                        }
                    end
                }
            end
        }
        
        return windowObject
    end
}

return MemberLib
